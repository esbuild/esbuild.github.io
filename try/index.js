var Me=["absPaths","conditions","dropLabels","mainFields","resolveExtensions","target"];function q(e,i,t){let o=e.trimStart(),a=/^{|^\/[*/]/.test(o),r;if(!o)return t&&(t.innerHTML=""),{};if(a)r=Ke(e);else{let p=n=>{if(r[n]!==void 0)try{r[n]=new RegExp(r[n]+"")}catch(l){throw n=n.replace(/[A-Z]/g,h=>"-"+h.toLowerCase()),new Error(`Invalid regular expression for "--${n}=": ${l.message}`)}},c=n=>{if(r[n]!==void 0)try{r[n]=+r[n]}catch(l){throw n=n.replace(/[A-Z]/g,h=>"-"+h.toLowerCase()),new Error(`Invalid number for "--${n}=": ${l.message}`)}};r=qe(e,i),c("logLimit"),c("lineLimit"),p("mangleProps"),p("reserveProps");for(let n of Me)r[n]!==void 0&&(r[n]=(r[n]+"").split(","));let u=r.supported;if(typeof u=="object"&&u!==null)for(let n in u)u[n]==="true"?u[n]=!0:u[n]==="false"&&(u[n]=!1)}let s=r.tsconfigRaw;if(s!==void 0)try{s=JSON.parse(s)}catch{}return t&&(t.innerHTML="",ze(t,a,r,s,e),Ve(t,a,r,s)),r}function ze(e,i,t,o,a){if(o===void 0&&(o={}),typeof o!="object")return;let r=o.compilerOptions;if(r===void 0&&(r={}),typeof r=="object"&&(t.loader==="ts"||t.loader==="tsx")&&typeof r.experimentalDecorators!="boolean"){let s={...t,tsconfigRaw:{...o,compilerOptions:{...r,experimentalDecorators:!0}}},p;if(i)p=Ie(s);else if(t.tsconfigRaw===void 0)p=[a,/\n/.test(a)?`
`:" ",le({tsconfigRaw:s.tsconfigRaw})].join("");else try{p=le(s)}catch{}if(p!==void 0){let c=document.createElement("a");c.href="javascript:void 0",c.textContent="Enable TS experimental decorators",c.onclick=()=>{let u=e.parentElement.querySelector("textarea");e.innerHTML="",u.value=p,u.dispatchEvent(new Event("input"))},e.append(c," ")}}}function Ve(e,i,t,o){let a,r=document.createElement("a");if(i)try{a=le(t),r.textContent="Switch to CLI syntax"}catch{}else a=Ie(o?{...t,tsconfigRaw:o}:t),r.textContent="Switch to JS syntax";a!==void 0&&(r.href="javascript:void 0",r.onclick=()=>{let s=e.parentElement.querySelector("textarea");e.innerHTML="",s.value=a,s.dispatchEvent(new Event("input"))},e.append(r))}function qe(e,i){let t=[],o=e.length,a=0,r=0,s=0;for(;s<o;){let n=s,l=a,h=s-r,f="",d=e[s];if(d===" "||d==="	"||d===`
`){s++,d===`
`&&(a++,r=s);continue}for(;s<o&&(d=e[s],!(d===" "||d==="	"||d===`
`));)if(s++,d==="\\"&&s<o)d=e[s++],d===`
`?(a++,r=s):f+=d;else if(d==="'"){let g=a,m=s-r-1;for(;s===o&&ae(e,"'",g,m,a,s-r),d=e[s++],d!=="'";){if(d==="\\"&&s<o&&e[s]!=="'"&&(d=e[s++],d===`
`)){a++,r=s;continue}d===`
`&&(a++,r=s),f+=d}}else if(d==='"'){let g=a,m=s-r-1;for(;s===o&&ae(e,'"',g,m,a,s-r),d=e[s++],d!=='"';){if(d==="\\"&&s<o&&(d=e[s++],d===`
`)){a++,r=s;continue}d===`
`&&(a++,r=s),f+=d}}else f+=d;t.push({$e:f,_:l,ye:h,Be:s-n})}let p=[],c=Object.create(null),u=(n,l)=>(n!==n.toLowerCase()&&v(e,"Invalid CLI-style flag: "+JSON.stringify("--"+n),l._,l.ye,n.length+2),n.replace(/-(\w)/g,(h,f)=>f.toUpperCase()));for(let{$e:n,...l}of t){let h=n.indexOf("=");if(n.startsWith("--")){let f=n.indexOf(":");if(f>=0&&h<0){let d=u(n.slice(2,f),l),g=n.slice(f+1);(!(d in c)||!Array.isArray(c[d]))&&(c[d]=[]),c[d].push(g)}else if(f>=0&&f<h){let d=u(n.slice(2,f),l),g=n.slice(f+1,h),m=n.slice(h+1);(!(d in c)||typeof c[d]!="object"||Array.isArray(c[d]))&&(c[d]=Object.create(null)),c[d][g]=m}else if(h>=0){let d=n.slice(h+1);c[u(n.slice(2,h),l)]=d==="true"?!0:d==="false"?!1:d}else c[u(n.slice(2),l)]=!0}else n.startsWith("-")||i===0?v(e,'All CLI-style flags must start with "--"',l._,l.ye,l.Be):(c.entryPoints=p,p.push(h<0?n:{in:n.slice(h+1),out:n.slice(0,h)}))}return p.length&&(c.entryPoints=p),c}function Ke(e){let i=()=>{let f=l.A===13?"string":(l.A===10?"identifier ":"")+JSON.stringify(l.$e);return v(e,`Unexpected ${f} in ${s}`,l._,l.ye,l.$e.length)},t=(f,d,g)=>v(e,`Expected "${d}" after ${g} in ${s}`,f._,f.ye+f.$e.length,0,"",0,0,0,d),o=(f=0)=>{for(;n<p;){let d=c,g=n-u,m=e[n];if(m===`
`){c++,u=++n;continue}if(m===" "||m==="	"){n++;continue}if(m==="/"){let L=n++;if(n<p&&e[n]==="/"){for(n++;n<p&&e[n]!==`
`;)n++;continue}if(n<p&&e[n]==="*"){for(n++;;)if(n===p&&v(e,'Expected "*/" to terminate multi-line comment',c,n-u,0,"The multi-line comment starts here:",d,g,2,"*/"),m=e[n++],m===`
`)c++,u=n;else if(m==="*"&&n<p&&e[n]==="/"){n++;break}continue}let x=0;for(;(n===p||e[n]===`
`)&&(x?v(e,'Expected "]" to terminate character class',c,n-u,0,"The character class starts here:",c,x-u,1,"]"):v(e,'Expected "/" to terminate regular expression',c,n-u,0,"The regular expression starts here:",d,g,1,"/")),m=e[n++],!(m==="/"&&!x);)m==="]"&&x?x=0:m==="["?x=n-1:m==="\\"&&n<p&&e[n]!==`
`&&n++;for(;n<p&&/\w/.test(e[n]);)n++;let E=e.slice(L,n),T;try{T=(0,eval)(E)}catch{v(e,`Invalid regular expression in ${s}`,d,g,n-L)}l={_:d,ye:g,A:12,$e:E,be:T};return}f&2&&v(e,`Expected end of file after ${s}`,c,n-u,0);let O="-,:[]{}()+".indexOf(m);if(O>=0){n++,l={_:d,ye:g,A:O,$e:m,be:m};return}if(m==="."||m>="0"&&m<="9"){let L=/^[\.\w]$/,x=n++;for(;n<p&&L.test(e[n]);)n++;let E=e.slice(x,n);if(!/\d/.test(E))n=x;else{let T=+E;T!==T&&v(e,`Invalid number "${E}" in ${s}`,d,g,n-x),l={_:d,ye:g,A:12,$e:E,be:T};return}}let w=/^[\w\$]$/;if(w.test(m)){let L=n++;for(;n<p&&w.test(e[n]);)n++;let x=e.slice(L,n),E=12,T=x;f&1?E=10:x==="null"?T=null:x==="true"?T=!0:x==="false"?T=!1:x==="undefined"?T=void 0:x==="Infinity"?T=1/0:x==="NaN"?T=NaN:x==="function"?E=11:E=10,l={_:d,ye:g,A:E,$e:x,be:T};return}if(m==='"'||m==="'"){let L=n++;for(;;)if((n===p||e[n]===`
`)&&ae(e,m,d,g,c,n-u),e[n]==="\\"&&n+1<p)n+=2,e[n-1]===`
`&&(c++,u=n);else if(e[n++]===m)break;let x=e.slice(L,n),E;try{E=(0,eval)(x)}catch{v(e,`Invalid string in ${s}`,d,g,n-L)}l={_:d,ye:g,A:13,$e:x,be:E};return}v(e,`Unexpected ${JSON.stringify(m)} in ${s}`,c,n-u,1)}f&2||v(e,`Unexpected end of file in ${s}`,c,n-u,0)},a=(f,d)=>{let g=/\}/g,m="";g.lastIndex=d;for(let O;O=g.exec(e);)try{let w=new Function("return {"+f+e.slice(d,O.index+1)+"}."+f);return n=O.index+1,w()}catch(w){m=": "+w.message}v(e,"Invalid function literal"+m,l._,l.ye,l.$e.length)},r=()=>{if(l.A===5){let f=Object.create(null),d=Object.create(null);for(;o(1),l.A!==6;){l.A!==13&&l.A!==10&&i();let g=d[l.be];g&&v(e,`Duplicate key ${JSON.stringify(l.be)} in object literal`,l._,l.ye,l.$e.length,`The original key ${JSON.stringify(l.be)} is here:`,g._,g.ye,g.$e.length);let m=l,O=n,w;o(),l.A===7?w=a(m.be,O):(l.A!==2&&t(m,":","property "+JSON.stringify(m.be)),o(),l.A===11?w=a(m.be,O):w=r()),f[m.be]=w,d[m.be]=m;let L=l;if(o(),l.A===6)break;l.A!==1&&t(L,",","property "+JSON.stringify(m.be))}return f}if(l.A===3){let f=[],d=0;for(;o(),l.A!==4;)if(l.A!==1){f[d++]=r();let g=l;if(o(),l.A===4)break;l.A!==1&&t(g,",","array element")}else f.length=++d;return f}return l.A===12||l.A===13?l.be:l.A===9?(o(),+r()):l.A===0?(o(),-r()):i()},s="JSON5 value",p=e.length,c=0,u=0,n=0,l;o();let h=r();return o(2),h}function v(e,i,t,o,a,r="",s=0,p=0,c=0,u){let n=e.split(`
`),l=new Error(i);throw l.Oe={We:"<options>",_:t+1,ye:o,Be:a,Je:n[t],Ke:u},r&&(l.Ge=[{$e:r,Oe:{We:"<options>",_:s+1,ye:p,Be:c,Je:n[s]}}]),l}function ae(e,i,t,o,a,r){let s=i==='"'?"double":"single";v(e,`Failed to find the closing ${s} quote`,a,r,0,`The opening ${s} quote is here:`,t,o,1,i)}function le(e){let i=a=>/[ \t\n\\'"]/.test(a)?'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"':a,t=a=>a.replace(/[A-Z]/g,r=>"-"+r.toLowerCase()),o=[];for(let a in e){let r=t(a),s=e[a],p=typeof s;if(p==="string"||p==="boolean"||p==="number"||s===null)o.push(s===!0?"--"+r:`--${r}=${s}`);else if(Array.isArray(s))if(Me.includes(a))o.push(`--${r}=${s}`);else for(let c of s)o.push(a==="entryPoints"?typeof c=="object"&&c!==null&&typeof c.in=="string"&&typeof c.out=="string"?`${c.out}=${c.in}`:c:`--${r}:${c}`);else if(s instanceof RegExp)o.push(`--${r}=${s.source}`);else if(a==="tsconfigRaw")o.push(`--${r}=${JSON.stringify(s)}`);else if(p==="object"&&a!=="mangleCache"&&a!=="stdin")for(let c in s)o.push(`--${r}:${c}=${s[c]}`);else throw new Error("Not representable")}return o.map(i).join(" ")}function Ie(e){let i=(t,o,a=!0)=>{let r=typeof t;if(r==="string"){let c=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\n"),u=c.split("'"),n=c.split('"');return n.length<u.length?'"'+n.join('\\"')+'"':"'"+u.join("\\'")+"'"}if(r==="boolean"||r==="number"||t instanceof RegExp)return t+"";let s=o+"  ";if(Array.isArray(t)){let c=t.every(n=>typeof n=="string"),u="[";for(let n of t)u+=u==="["?c?"":`
`+s:c?", ":s,u+=i(n,s,!1),c||(u+=`,
`);return u!=="["&&!c&&(u+=o),u+"]"}let p="{";for(let c in t){let u=t[c];p+=p==="{"?a?`
`+s:" ":a?s:", ",p+=`${/^[A-Za-z$_][A-Za-z0-9$_]*$/.test(c)?c:i(c,"")}: ${i(u,s)}`,a&&(p+=`,
`)}return p!=="{"&&(p+=a?o:" "),p+"}"};return i(e,"")}function j(e){let i=document.createElement("a");return i.className="underLink",i.href="javascript:void 0",i.target="_blank",i.textContent="Visualize this source map",i.onclick=()=>{let[t,o]=e(),a=`${t.length}\0${t}${o.length}\0${o}`;i.href="https://evanw.github.io/source-map-visualization/#"+btoa(a),setTimeout(()=>i.href="javascript:void 0")},i}function Ge(e){let i=/\/(\/)[#@] *sourceMappingURL=([^\s]+)/.exec(e);return i||(i=/\/(\*)[#@] *sourceMappingURL=((?:[^\s*]|\*[^/])+)(?:[^*]|\*[^/])*\*\//.exec(e)),i&&i[2]}function P(e,i,t){let o=Ge(i);if(t&&t.remove(),o){let a;try{o.startsWith("data:application/json;base64,")?a=JSON.parse(atob(o.slice(29))):o.startsWith("data:application/json;charset=utf-8,")&&(a=JSON.parse(decodeURIComponent(o.slice(36))))}catch{}a&&typeof a=="object"&&(t=j(()=>[i,JSON.stringify(a)]),e.append(t))}return t}var S=document.getElementById("outputResult"),G=document.createElement("textarea"),fe=document.createElement("textarea"),X=document.createElement("textarea"),me=document.createElement("textarea"),Z=document.createElement("textarea"),de=[],Ze=new TextEncoder,N,pe,ue=!1,Ce=e=>pe?pe.format(e):e+"",ce=e=>{let i=e.toFixed(1).split(".",2);return Ce(+i[0])+"."+i[1]},Xe=e=>e===1?"1 byte":e<1024?Ce(e)+" bytes":e<1024*1024?ce(e/1024)+" kb":e<1024*1024*1024?ce(e/(1024*1024))+" mb":ce(e/(1024*1024*1024))+" gb";C(G,!0);C(fe,!0);C(X,!0);C(me,!0);C(Z,!0);function b(e){document.body.style.paddingBottom=e.clientHeight+"px",e.style.height="0",e.style.height=e.scrollHeight+1+"px",document.body.style.paddingBottom="0"}function C(e,i){e.readOnly=i,e.spellcheck=!1,e.autocapitalize="off",e.autocomplete="off"}function Y(e){let i=`\x1B[31m\u2718 \x1B[41;31m[\x1B[41;97mERROR\x1B[41;31m]\x1B[0m \x1B[1m${e&&e.message||e}\x1B[0m`,t=e&&e.Oe,o=e&&e.Ge;if(t&&(i+=Oe(t)),o)for(let a of o)i+=`
  ${a.$e}`,a.Oe&&(i+=Oe(a.Oe));return i}function Oe({We:e,_:i,ye:t,Be:o,Je:a,Ke:r}){let p=a.length,c=o<2?"^":"~".repeat(o),u=`

    ${e}:${i}:${t}:
`;if(p>80){let n=Math.max(0,Math.min(t*2+o-80>>1,t-16,p-80)),l=a.slice(n,n+80);t=Math.max(0,t-n),o=Math.min(o,l.length-t),l.length>3&&n>0&&(l="..."+l.slice(3),t=Math.max(t,3)),l.length>3&&n+80<p&&(l=l.slice(0,l.length-3)+"...",o=Math.max(0,Math.min(o,l.length-3-t))),a=l}return u+=`\x1B[37m${i.toString().padStart(7)} \u2502 ${a.slice(0,t)}\x1B[32m${a.slice(t,t+o)}\x1B[37m${a.slice(t+o)}
`,r&&(u+=`        \u2502 ${" ".repeat(t)}\x1B[32m${c}\x1B[37m
`,c=r),u+=`        \u2575 ${" ".repeat(t)}\x1B[32m${c}\x1B[0m
`,u}function H(e,i,t){if(t!==void 0){let o=document.createElement("div");return e.textContent=t.replace(/\n$/,""),o.id=i,o.className="hasLabel",o.append(e),S.append(o),b(e),o}}function ge({Ze:e,Ye:i,Ne:t,Xe:o,ve:a}){if(S.innerHTML="",H(G,"transformOutput",e),i?(H(Z,"sourceMap",i),N&&N.remove(),N=j(()=>[e||"",JSON.stringify(JSON.parse(i))]),Z.parentElement.append(N)):N=P(G.parentElement,e||"",N),t&&H(X,"transformMangleCache",JSON.stringify(t,null,2)),H(fe,"legalComments",o),a){let r=document.createElement("div");r.id="stderrLog",r.innerHTML=$e(a),S.append(r)}if(e===void 0&&!a){let r=document.createElement("div");r.id="outputStatus",r.textContent="(no output)",S.append(r)}}function he({et:e,tt:i,Ne:t,ve:o},a){if(S.innerHTML="",de.length=0,e){e.sort((r,s)=>+(r.path>s.path)-+(r.path<s.path));for(let r of e){let s=document.createElement("div"),p=document.createElement("div"),c=document.createElement("span"),u=document.createElement("textarea");if(p.className="outputPath",p.textContent=r.path.replace(/^\//,""),c.textContent=" ("+Xe(Ze.encode(r.text).length)+")",p.append(c),u.readOnly=!0,u.value=r.text.replace(/\n$/,""),C(u,!0),s.className="buildOutput hasLabel",s.append(u),r.path.endsWith(".map")){for(let n of e)if(r.path===n.path+".map"){s.append(j(()=>[n.text,JSON.stringify(JSON.parse(r.text))]));break}}else P(s,r.text,void 0);S.append(p,s),de.push(u),b(u)}}if(o){let r=document.createElement("div");r.id="stderrLog",r.innerHTML=$e(o),S.append(r)}if((!e||!e.length)&&!o){let r=document.createElement("div");r.id="outputStatus",r.textContent=a?"(no output)":"(no entry points)",S.append(r)}if(t&&H(X,"mangleCache",JSON.stringify(t,null,2)),i){let r=H(me,"metafile",JSON.stringify(i,null,2)),s=document.createElement("a");s.className="underLink",s.href="javascript:void 0",s.target="_blank",s.textContent="Analyze this metafile",s.onclick=()=>{s.href="/analyze/#"+btoa(JSON.stringify(i)),setTimeout(()=>s.href="javascript:void 0")},r.append(s)}}function U(e){e&&(ue=!1),!ue&&(S.innerHTML=`<span id="outputStatus">Loading${e?" version "+e:""}...</span>`)}function Be(e){ue=!0,S.innerHTML="";let i=document.createElement("div");i.className="problem",i.innerHTML=`\u274C Failed to load esbuild: ${e}`,S.append(i)}function $e(e){return"<span>"+e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\x1B\[([^m]*)m/g,(i,t)=>{switch(t){case"1":return'</span><span class="color-bold">';case"4":return'</span><span class="color-underline">';case"31":return'</span><span class="color-red">';case"32":return'</span><span class="color-green">';case"33":return'</span><span class="color-yellow">';case"35":return'</span><span class="color-magenta">';case"37":return'</span><span class="color-dim">';case"41;31":return'</span><span class="bg-red color-red">';case"41;97":return'</span><span class="bg-red color-white">';case"43;33":return'</span><span class="bg-yellow color-yellow">';case"43;30":return'</span><span class="bg-yellow color-black">';case"0":return"</span><span>"}throw new Error(`Unknown escape sequence: ${t}`)})+"</span>"}addEventListener("resize",()=>{if(M===0)b(G),b(Z),b(fe);else{for(let e of de)b(e);b(me)}b(X)});try{pe=new Intl.NumberFormat}catch{}var R=document.querySelector("#transformOptions textarea"),Ye=document.querySelector("#transformOptions .underLink"),$=document.querySelector("#transformInput textarea"),xe=document.querySelector("#transformInput .underLink"),Pe;function Re(){return[R.value,$.value]}function be(e,i){(R.value!==e||$.value!==i)&&(R.value=e,$.value=i,D()),W()}function W(){b(R),b($)}function D(){let e=R.value,i=$.value;Q(),Pe=P($.parentElement,i,Pe);try{_({je:"transform",Ue:i,Ie:q(e,0,Ye)}).then(t=>{ge(t)},()=>{})}catch(t){ge({ve:Y(t)})}if(xe.innerHTML="",!e&&!i){let t=document.createElement("a");t.href="javascript:void 0",t.textContent="Load an example...",t.onclick=Ae,xe.append(t)}}function Ae(){be(`--target=es6
--loader=tsx
--jsx=automatic
--minify-identifiers
--sourcemap`,`// The "tsx" loader removes type annotations
export type NamesProps = { names?: string[] }

export const NamesComponent = (props: NamesProps) => {
  // The "?." operator will be transformed for ES6
  const names = props.names?.join(' ')

  // The "tsx" loader transforms JSX syntax into JS
  return <div>Names: {names}</div>
}`)}R.oninput=()=>{b(R),D()};$.oninput=()=>{b($),D()};xe.querySelector("a").onclick=Ae;addEventListener("resize",W);W();var je=Qe(),k=document.querySelector("#versionPicker select"),ee=document.createElement("option"),te;ee.textContent="Loading...";k.append(ee);k.disabled=!0;je.then(e=>{let i=e.filter(t=>!/^0\.[0-4]\.|^0\.5\.0/.test(t));k.disabled=!1,ee.remove();for(let t of i){let o=document.createElement("option");o.textContent=t,k.append(o)}k.onchange=()=>te(k.value),k.selectedIndex=-1},()=>{ee.textContent="\u274C Loading failed!"});function Ne(){return k.disabled?null:k.selectedIndex<0?"pkgurl":k.value}function ye(e){te=e}async function z(e){if(e==="pkgurl")k.selectedIndex!==-1&&(k.selectedIndex=-1,await te("pkgurl"));else{let i=await je,t=e==="latest"?i.length?0:-1:i.indexOf(e);t>=0&&k.selectedIndex!==t&&(k.selectedIndex=t,await te(i[t]))}}async function Qe(){let e=new AbortController,i=setTimeout(()=>e.abort("Timeout"),5e3);try{let t="https://data.jsdelivr.com/v1/package/npm/esbuild-wasm",o=await fetch(t,{signal:e.signal});if(o&&o.ok){clearTimeout(i);let a=(await o.json()).versions;if(a&&a.length)return console.log(`Loaded ${a.length} versions from ${t}`),a}}catch(t){console.error(t)}try{let t="https://registry.npmjs.org/esbuild-wasm",o=(await fetch(t).then(a=>a.json())).versions;if(o&&(o=Object.keys(o).reverse(),o.length))return console.log(`Loaded ${o.length} versions from ${t}`),o}catch(t){console.error(t)}throw new Error}function He(){let e=decodeURIComponent(escape(atob(location.hash.slice(1)))).split("\0");if(e[0]==="t"&&e.length===4)return V(0),be(e[2],e[3]),z(e[1]),!0;if(e[0]==="b"&&e.length%3===0){let i=[];for(let t=3;t<e.length;t+=3)i.push({ke:e[t]==="e",Te:e[t+1],we:e[t+2]});return V(1),Ee(e[2],i),z(e[1]),!0}if(location.hash!=="")try{history.replaceState({},"",location.pathname+location.search)}catch{}return!1}function Q(){let e=Ne();if(!e)return;let i;if(M===0){let[o,a]=Re();(o||a)&&(i=["t",e,o,a])}else{let[o,a]=ve();i=["b",e,o];for(let r of a)i.push(r.ke?"e":"",r.Te,r.we)}let t=location.pathname+location.search;try{let o=i?"#"+btoa(unescape(encodeURIComponent(i.join("\0")))).replace(/=+$/,""):"";location.hash!==o&&history.replaceState({},"",o||t)}catch{if(location.hash!=="")try{history.replaceState({},"",t)}catch{}}}var A=document.querySelector("#buildOptions textarea"),_e=document.querySelector("#buildOptions .underLink"),Te=document.getElementById("addInput"),et=document.getElementById("buildInputs"),y=[];function ve(){return[A.value,y.map(e=>({ke:e.Le.classList.contains("entryPoint"),Te:e.Se.value.trim(),we:e.Re.value}))]}function Ee(e,i){if(JSON.stringify([e,i])!==JSON.stringify(ve())){for(let t of y)t.Le.remove();y.length=0,A.value=e;for(let t of i)we(t.ke,t.Te,t.we);F(),I()}ne()}function Fe(){y.length||we(!0,ke())}function ne(){b(A);for(let e of y)b(e.Re)}function I(){Q();try{let e=q(A.value,1,_e),i=Array.isArray(e.entryPoints)?e.entryPoints:e.entryPoints=[],t=Object.create(null),o=Object.create(null),a;for(let r of y){let s=r.Se.value.trim();if((o[s]||(o[s]=[])).push(r),s)t[s]=r.Re.value,r.Le.classList.contains("entryPoint")&&!i.includes(s)&&i.push(s);else{let c=e.stdin&&typeof e.stdin=="object"?e.stdin:e.stdin={};c.contents=r.Re.value,"resolveDir"in c||(c.resolveDir="/")}}for(let r in o){let s=o[r];if(s.length>1){for(let p of s)p.Le.classList.add("duplicate");a||(a=new Error("Duplicate input file: "+(r?JSON.stringify(r):"<stdin>")))}else s[0].Le.classList.remove("duplicate")}if(a)throw a;_({je:"build",Ue:t,Ie:e}).then(r=>{he(r,i.length)},()=>{})}catch(e){he({ve:Y(e)},-1)}for(let e of y)e.Ve.innerHTML="";if(!A.value&&y.length===1&&!y[0].Re.value){let e=document.createElement("a");e.href="javascript:void 0",e.textContent="Load an example...",e.onclick=()=>Ee(`--bundle
--format=esm
--outfile=out.js
--sourcemap
--drop-labels:DEBUG
--minify-identifiers`,[{ke:!0,Te:"entry.ts",we:`// This import will be inlined by the bundler
import * as UnionFind from '@example/union-find'

// Type declarations are automatically removed
export type Graph<K, V> = Map<K, Node<K, V>>
export interface Node<K, V> {
  data: V
  edges: K[]
}

export function connectedComponents<K, V>(graph: Graph<K, V>) {
  let groups = UnionFind.create(graph.keys())
  let result = new Map<K, K[]>()

  for (let [key, { edges }] of graph)
    for (let edge of edges)
      UnionFind.union(groups, key, edge)

  // This is removed by "--drop-labels:DEBUG"
  DEBUG: console.log('Groups: ' +
    UnionFind.debugString(groups))

  for (let key of graph.keys()) {
    let group = UnionFind.find(groups, key)
    let component = result.get(group) || []
    component.push(key)
    result.set(group, component)
  }

  return [...result.values()]
}

// This is removed by "--drop-labels:DEBUG"
DEBUG: {
  let observed = JSON.stringify(
    connectedComponents(new Map([
      ['A', { data: 1, edges: ['C'] }],
      ['B', { data: 2, edges: ['B'] }],
      ['C', { data: 3, edges: ['A', 'B'] }],
      ['X', { data: -1, edges: ['Y'] }],
      ['Y', { data: -2, edges: ['X'] }],
      ['Z', { data: -3, edges: [] }],
    ])))
  let expected = '[["A","B","C"],["X","Y"],["Z"]]'
  console.assert(observed === expected,
    \`Expected \${expected} but got \${observed}\`)
}`},{ke:!1,Te:"node_modules/@example/union-find/index.js",we:`// See: https://en.wikipedia.org/wiki/Disjoint-set_data_structure

export function create(keys) {
  let map = new Map()
  for (let x of keys)
    map.set(x, x)
  return map
}

export function find(map, x) {
  while (map.get(x) !== x)
    map.set(x, x = map.get(map.get(x)))
  return x
}

export function union(map, a, b) {
  map.set(find(map, a), find(map, b))
}

// This is removed by tree-shaking when unused
export function debugString(map) {
  let obj = {}
  for (let [k, v] of map) {
    obj[k] = v
    while (map.get(v) !== v)
      obj[k] += ' => ' + (v = map.get(v))
  }
  return JSON.stringify(obj, null, 2)
}`},{ke:!1,Te:"node_modules/@example/union-find/index.d.ts",we:`// Files related to type checking are ignored by esbuild
export declare function create<T>(keys: Iterable<T>): Map<T, T>;
export declare function find<T>(map: Map<T, T>, x: T): T;
export declare function union<T>(map: Map<T, T>, a: T, b: T): void;
export declare function debugString<T>(map: Map<T, T>): string;`}]),y[0].Ve.append(e)}}function ke(){if(!y.length)return"entry.js";let e=1,i="file.js";for(;y.some(t=>t.Se.value.trim()===i);)i=`file${++e}.js`;return i}function F(){Te.textContent="+ "+ke()}function we(e=!1,i="",t=""){let o=()=>{let f=p.value;if(f.endsWith(".map")){let d;try{d=JSON.parse(u.value)}catch{}if(d&&typeof d=="object"){h=j(()=>{let g="";for(let m of y)if(f===m.Se.value+".map"){g=m.Re.value;break}return[g,JSON.stringify(d)]}),a.append(h);return}}h=P(a,u.value,h)},a=document.createElement("div"),r=document.createElement("a"),s=document.createElement("a"),p=document.createElement("input"),c=document.createElement("div"),u=document.createElement("textarea"),n=document.createElement("div"),l={Le:a,Se:p,Re:u,Ve:n},h;return C(p,!1),C(u,!1),p.placeholder="<stdin>",p.value=i,r.className="entryToggle",r.textContent="",r.href="javascript:void 0",s.className="remove",s.textContent="\xD7",s.href="javascript:void 0",u.placeholder="(enter your code here)",u.value=t,a.className="buildInput",e&&a.classList.add("entryPoint"),c.className="hasLabel",c.append(u),n.className="underLink",a.append(r,p,s,c,n),et.insertBefore(a,Te),p.oninput=()=>{o(),F(),I()},p.onblur=()=>{let f=p.value.trim();p.value!==f&&(p.value=f,F(),I())},u.oninput=()=>{o(),b(u),I()},r.onclick=()=>{a.classList.toggle("entryPoint"),I()},s.onclick=()=>{let f=y.indexOf(l);f<0||(y.splice(f,1),a.remove(),F(),I())},y.push(l),o(),F(),b(u),l}A.oninput=()=>{b(A),I()};Te.onclick=()=>{let e=we(!y.length,ke());e.Se.focus(),e.Se.select(),I()};addEventListener("resize",ne);F();var M=0,Je=[document.getElementById("transformPanel"),document.getElementById("buildPanel")],tt=document.getElementById("modeSwitcher"),oe=tt.querySelectorAll("a");oe[0].onclick=()=>{V(0)&&(U(null),re())};oe[1].onclick=()=>{Fe(),V(1)&&(U(null),re())};function V(e){return M===e?!1:(oe[M].classList.remove("active"),Je[M].style.display="none",M=e,oe[M].classList.add("active"),Je[M].style.display="block",!0)}function re(){M===0?(W(),D()):(ne(),I())}var De=new URLSearchParams(location.search),Le=De.get("polywasm"),se=De.get("pkgurl"),nt=fetch("worker.js").then(e=>e.text()),J=null,B=null,ie=new Promise((e,i)=>{ye(t=>{let o=We(t);return o.then(e,i),ye(a=>(ie.then(r=>r.terminate()),ie=We(a),ie)),o})});async function Ue(e){let i=new AbortController,t=setTimeout(()=>i.abort("Timeout"),5e3);try{let o=await fetch(`https://cdn.jsdelivr.net/npm/${e}`,{signal:i.signal});if(o.ok)return clearTimeout(t),o}catch(o){console.error(o)}return fetch(`https://unpkg.com/${e}`)}async function We(e){let i,t,o;U(e==="pkgurl"?null:e);try{if(J&&J.De(),B&&B.De(),J=null,B=null,e==="pkgurl")t=fetch(new URL("lib/browser.min.js",se)),o=fetch(new URL("esbuild.wasm",se));else{let[l,h,f]=e.split(".").map(g=>+g),d=l===0&&(h<8||h===8&&f<33)?"":".min";t=Ue(`esbuild-wasm@${e}/lib/browser${d}.js`),o=Ue(`esbuild-wasm@${e}/esbuild.wasm`)}let a=l=>l.then(h=>{if(!h.ok)throw`${h.status} ${h.statusText}: ${h.url}`;return h}),r=Le==="0"||Le==="1"?Le:null,[s,p,c]=await Promise.all([nt,a(t).then(l=>l.text()),a(o).then(l=>l.arrayBuffer())]),u=[p,`
var polywasm=${r};`,s],n=URL.createObjectURL(new Blob(u,{type:"application/javascript"}));return await new Promise((l,h)=>{let f=new Worker(n);f.onmessage=d=>{if(d.data.Ae==="slow"){let g=document.getElementById("slowWarning");g.innerHTML="<span>\u26A0\uFE0F Processing is slow because </span><span>WebAssembly is disabled \u26A0\uFE0F</span>",g.style.display="flex";return}f.onmessage=null,d.data.Ae==="success"?(l(f),re()):(h(new Error("Failed to create worker")),i=d.data.nt),URL.revokeObjectURL(n)},f.postMessage([e,c],[c])})}catch(a){throw Be(i||a+""),a}}function _(e){let i=(t,o)=>{J?(B&&B.De(),B=o):(J=o,t.onmessage=a=>{t.onmessage=null,o.rt(a.data),J=null,B&&(i(t,B),B=null)},t.postMessage(o.ot))};return new Promise((t,o)=>{ie.then(a=>i(a,{ot:Se(e),rt:t,De:()=>o(new Error("Task aborted"))}),o)})}var Se=e=>{if(typeof e=="function"){let i=e+"";return new EvalError("function "+e.name+i.slice(i.indexOf("(")))}return typeof e=="object"&&e&&!(e instanceof RegExp)?Array.isArray(e)?e.map(Se):Object.fromEntries(Object.entries(e).map(([i,t])=>[i,Se(t)])):e};He()||z(se?"pkgurl":"latest");
